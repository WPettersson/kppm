FILE(GLOB TESTS *.lp)
FOREACH(TESTFILE ${TESTS})
  GET_FILENAME_COMPONENT(TESTNAME ${TESTFILE} NAME_WE)
  ADD_TEST(NAME ${TESTNAME} COMMAND
    "${PROJECT_SOURCE_DIR}/scripts/checkResults.sh"
    $<TARGET_FILE:kppm>
    "${TESTFILE}")
  GET_FILENAME_COMPONENT(TESTNAME ${TESTFILE} NAME_WE)
  ADD_TEST(NAME "${TESTNAME}-2-threads" COMMAND
    "${PROJECT_SOURCE_DIR}/scripts/checkResults.sh"
    $<TARGET_FILE:kppm>
    "${TESTFILE}"
    "-t 2 -s 2")
  ADD_TEST(NAME "${TESTNAME}-2-threads-sharing" COMMAND
    "${PROJECT_SOURCE_DIR}/scripts/checkResults.sh"
    $<TARGET_FILE:kppm>
    "${TESTFILE}"
    "-t 2 -s 2 -r")
ENDFOREACH(TESTFILE)
